THREE.DeviceOrientationControls=function(a){this.object=a,this.object.rotation.reorder("YXZ"),this.freeze=!0,this.movementSpeed=1,this.rollSpeed=.005,this.autoAlign=!0,this.autoForward=!1,this.alpha=0,this.beta=0,this.gamma=0,this.orient=0,this.alignQuaternion=new THREE.Quaternion,this.orientationQuaternion=new THREE.Quaternion;var b=new THREE.Quaternion,c=new THREE.Quaternion,d=new THREE.Vector3,e=new THREE.Matrix4,f=new THREE.Euler(0,0,0,"YXZ"),g=new THREE.Quaternion,h=new THREE.Vector3(0,0,1),i=new THREE.Vector3(0,1,0),j=new THREE.Vector3(0,0,0),k=new THREE.Euler,l=new THREE.Quaternion,m=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));this.deviceOrientation={},this.screenOrientation=window.orientation||0,this.onDeviceOrientationChangeEvent=function(a){this.deviceOrientation=a}.bind(this);var n=function(){switch(window.screen.orientation||window.screen.mozOrientation){case"landscape-primary":return 90;case"landscape-secondary":return-90;case"portrait-secondary":return 180;case"portrait-primary":return 0}return window.orientation||0};this.onScreenOrientationChangeEvent=function(){this.screenOrientation=n()}.bind(this),this.update=function(a){return function(){if(!this.freeze){var a=n();a!==this.screenOrientation&&(this.screenOrientation=a,this.autoAlign=!0),this.alpha=this.deviceOrientation.gamma?THREE.Math.degToRad(this.deviceOrientation.alpha):0,this.beta=this.deviceOrientation.beta?THREE.Math.degToRad(this.deviceOrientation.beta):0,this.gamma=this.deviceOrientation.gamma?THREE.Math.degToRad(this.deviceOrientation.gamma):0,this.orient=this.screenOrientation?THREE.Math.degToRad(this.screenOrientation):0,k.set(this.beta,this.alpha,-this.gamma,"YXZ"),b.setFromEuler(k),c.slerp(b,.5),this.autoAlign?this.orientationQuaternion.copy(b):this.orientationQuaternion.copy(c),this.orientationQuaternion.multiply(m),this.orientationQuaternion.multiply(l.setFromAxisAngle(h,-this.orient)),this.object.quaternion.copy(this.alignQuaternion),this.object.quaternion.multiply(this.orientationQuaternion),this.autoForward&&(d.set(0,0,-1).applyQuaternion(this.object.quaternion,"ZXY").setLength(this.movementSpeed/50),this.object.position.add(d)),this.autoAlign&&0!==this.alpha&&(this.autoAlign=!1,this.align())}}}(),this.align=function(){d.set(0,0,-1).applyQuaternion(g.copy(this.orientationQuaternion).inverse(),"ZXY"),f.setFromQuaternion(g.setFromRotationMatrix(e.lookAt(d,j,i))),f.set(0,f.y,0),this.alignQuaternion.setFromEuler(f)},this.connect=function(){return this.onScreenOrientationChangeEvent(),window.addEventListener("deviceorientation",this.onDeviceOrientationChangeEvent,!1),this.freeze=!1,this},this.disconnect=function(){this.freeze=!0,window.removeEventListener("deviceorientation",this.onDeviceOrientationChangeEvent,!1)}},THREE.FirstPersonControls=function(a,b){function c(a,b){return function(){b.apply(a,arguments)}}this.object=a,this.target=new THREE.Vector3(0,0,0),this.domElement=void 0!==b?b:document,this.movementSpeed=1,this.lookSpeed=.5,this.lookVertical=!0,this.autoForward=!1,this.activeLook=!0,this.heightSpeed=!1,this.heightCoef=1,this.heightMin=0,this.heightMax=1,this.constrainVertical=!1,this.verticalMin=0,this.verticalMax=Math.PI,this.autoSpeedFactor=0,this.mouseX=0,this.mouseY=0,this.lat=0,this.lon=0,this.phi=0,this.theta=0,this.moveForward=!1,this.moveBackward=!1,this.moveLeft=!1,this.moveRight=!1,this.freeze=!1,this.mouseDragOn=!1,this.viewHalfX=0,this.viewHalfY=0,this.domElement!==document&&this.domElement.setAttribute("tabindex",-1),this.handleResize=function(){this.domElement===document?(this.viewHalfX=window.innerWidth/2,this.viewHalfY=window.innerHeight/2):(this.viewHalfX=this.domElement.offsetWidth/2,this.viewHalfY=this.domElement.offsetHeight/2)},this.onMouseDown=function(a){if(this.domElement!==document&&this.domElement.focus(),a.preventDefault(),a.stopPropagation(),this.activeLook)switch(a.button){case 0:this.moveForward=!0;break;case 2:this.moveBackward=!0}this.mouseDragOn=!0},this.onMouseUp=function(a){if(a.preventDefault(),a.stopPropagation(),this.activeLook)switch(a.button){case 0:this.moveForward=!1;break;case 2:this.moveBackward=!1}this.mouseDragOn=!1},this.onMouseMove=function(a){this.domElement===document?(this.mouseX=a.pageX-this.viewHalfX,this.mouseY=a.pageY-this.viewHalfY):(this.mouseX=a.pageX-this.domElement.offsetLeft-this.viewHalfX,this.mouseY=a.pageY-this.domElement.offsetTop-this.viewHalfY)},this.onKeyDown=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=!0;break;case 37:case 65:this.moveLeft=!0;break;case 40:case 83:this.moveBackward=!0;break;case 39:case 68:this.moveRight=!0;break;case 82:this.moveUp=!0;break;case 70:this.moveDown=!0;break;case 81:this.freeze=!this.freeze}},this.onKeyUp=function(a){switch(a.keyCode){case 38:case 87:this.moveForward=!1;break;case 37:case 65:this.moveLeft=!1;break;case 40:case 83:this.moveBackward=!1;break;case 39:case 68:this.moveRight=!1;break;case 82:this.moveUp=!1;break;case 70:this.moveDown=!1}},this.update=function(a){if(!this.freeze){if(this.heightSpeed){var b=THREE.Math.clamp(this.object.position.y,this.heightMin,this.heightMax),c=b-this.heightMin;this.autoSpeedFactor=a*c*this.heightCoef}else this.autoSpeedFactor=0;var d=a*this.movementSpeed;(this.moveForward||this.autoForward&&!this.moveBackward)&&this.object.translateZ(-(d+this.autoSpeedFactor)),this.moveBackward&&this.object.translateZ(d),this.moveLeft&&this.object.translateX(-d),this.moveRight&&this.object.translateX(d),this.moveUp&&this.object.translateY(d),this.moveDown&&this.object.translateY(-d);var e=a*this.lookSpeed;this.activeLook||(e=0);var f=1;this.constrainVertical&&(f=Math.PI/(this.verticalMax-this.verticalMin)),this.lon+=this.mouseX*e,this.lookVertical&&(this.lat-=this.mouseY*e*f),this.lat=Math.max(-85,Math.min(85,this.lat)),this.phi=THREE.Math.degToRad(90-this.lat),this.theta=THREE.Math.degToRad(this.lon),this.constrainVertical&&(this.phi=THREE.Math.mapLinear(this.phi,0,Math.PI,this.verticalMin,this.verticalMax));var g=this.target,h=this.object.position;g.x=h.x+100*Math.sin(this.phi)*Math.cos(this.theta),g.y=h.y+100*Math.cos(this.phi),g.z=h.z+100*Math.sin(this.phi)*Math.sin(this.theta),this.object.lookAt(g)}},this.connect=function(){this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousemove",c(this,this.onMouseMove),!1)},this.handleResize()},THREE.OrbitControls=function(a,b){function c(){return 2*Math.PI/60/60*m.autoRotateSpeed}function d(){return Math.pow(.95,m.zoomSpeed)}function e(a){if(m.enabled!==!1){if(a.preventDefault(),0===a.button){if(m.noRotate===!0)return;F=E.ROTATE,o.set(a.clientX,a.clientY)}else if(1===a.button){if(m.noZoom===!0)return;F=E.DOLLY,w.set(a.clientX,a.clientY)}else if(2===a.button){if(m.noPan===!0)return;F=E.PAN,r.set(a.clientX,a.clientY)}m.domElement.addEventListener("mousemove",f,!1),m.domElement.addEventListener("mouseup",g,!1),m.dispatchEvent(J)}}function f(a){if(m.enabled!==!1){a.preventDefault();var b=m.domElement===document?m.domElement.body:m.domElement;if(F===E.ROTATE){if(m.noRotate===!0)return;p.set(a.clientX,a.clientY),q.subVectors(p,o),m.rotateLeft(2*Math.PI*q.x/b.clientWidth*m.rotateSpeed),m.rotateUp(2*Math.PI*q.y/b.clientHeight*m.rotateSpeed),o.copy(p)}else if(F===E.DOLLY){if(m.noZoom===!0)return;x.set(a.clientX,a.clientY),y.subVectors(x,w),y.y>0?m.dollyIn():m.dollyOut(),w.copy(x)}else if(F===E.PAN){if(m.noPan===!0)return;s.set(a.clientX,a.clientY),t.subVectors(s,r),m.pan(t.x,t.y),r.copy(s)}m.update()}}function g(){m.enabled!==!1&&(m.domElement.removeEventListener("mousemove",f,!1),m.domElement.removeEventListener("mouseup",g,!1),m.dispatchEvent(K),F=E.NONE)}function h(a){if(m.enabled!==!1&&m.noZoom!==!0){a.preventDefault(),a.stopPropagation();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),b>0?m.dollyOut():m.dollyIn(),m.update(),m.dispatchEvent(J),m.dispatchEvent(K)}}function i(a){if(m.enabled!==!1&&m.noKeys!==!0&&m.noPan!==!0)switch(a.keyCode){case m.keys.UP:m.pan(0,m.keyPanSpeed),m.update();break;case m.keys.BOTTOM:m.pan(0,-m.keyPanSpeed),m.update();break;case m.keys.LEFT:m.pan(m.keyPanSpeed,0),m.update();break;case m.keys.RIGHT:m.pan(-m.keyPanSpeed,0),m.update()}}function j(a){if(m.enabled!==!1){switch(a.touches.length){case 1:if(m.noRotate===!0)return;F=E.TOUCH_ROTATE,o.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(m.noZoom===!0)return;F=E.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);w.set(0,d);break;case 3:if(m.noPan===!0)return;F=E.TOUCH_PAN,r.set(a.touches[0].pageX,a.touches[0].pageY);break;default:F=E.NONE}m.dispatchEvent(J)}}function k(a){if(m.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=m.domElement===document?m.domElement.body:m.domElement;switch(a.touches.length){case 1:if(m.noRotate===!0)return;if(F!==E.TOUCH_ROTATE)return;p.set(a.touches[0].pageX,a.touches[0].pageY),q.subVectors(p,o),m.rotateLeft(2*Math.PI*q.x/b.clientWidth*m.rotateSpeed),m.rotateUp(2*Math.PI*q.y/b.clientHeight*m.rotateSpeed),o.copy(p),m.update();break;case 2:if(m.noZoom===!0)return;if(F!==E.TOUCH_DOLLY)return;var c=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY,e=Math.sqrt(c*c+d*d);x.set(0,e),y.subVectors(x,w),y.y>0?m.dollyOut():m.dollyIn(),w.copy(x),m.update();break;case 3:if(m.noPan===!0)return;if(F!==E.TOUCH_PAN)return;s.set(a.touches[0].pageX,a.touches[0].pageY),t.subVectors(s,r),m.pan(t.x,t.y),r.copy(s),m.update();break;default:F=E.NONE}}}function l(){m.enabled!==!1&&(m.dispatchEvent(K),F=E.NONE)}this.object=a,this.domElement=void 0!==b?b:document,this.enabled=!0,this.target=new THREE.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var m=this,n=1e-6,o=new THREE.Vector2,p=new THREE.Vector2,q=new THREE.Vector2,r=new THREE.Vector2,s=new THREE.Vector2,t=new THREE.Vector2,u=new THREE.Vector3,v=new THREE.Vector3,w=new THREE.Vector2,x=new THREE.Vector2,y=new THREE.Vector2,z=0,A=0,B=1,C=new THREE.Vector3,D=new THREE.Vector3,E={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},F=E.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var G=(new THREE.Quaternion).setFromUnitVectors(a.up,new THREE.Vector3(0,1,0)),H=G.clone().inverse(),I={type:"change"},J={type:"start"},K={type:"end"};this.rotateLeft=function(a){void 0===a&&(a=c()),A-=a},this.rotateUp=function(a){void 0===a&&(a=c()),z-=a},this.panLeft=function(a){var b=this.object.matrix.elements;u.set(b[0],b[1],b[2]),u.multiplyScalar(-a),C.add(u)},this.panUp=function(a){var b=this.object.matrix.elements;u.set(b[4],b[5],b[6]),u.multiplyScalar(a),C.add(u)},this.pan=function(a,b){var c=m.domElement===document?m.domElement.body:m.domElement;if(void 0!==m.object.fov){var d=m.object.position,e=d.clone().sub(m.target),f=e.length();f*=Math.tan(m.object.fov/2*Math.PI/180),m.panLeft(2*a*f/c.clientHeight),m.panUp(2*b*f/c.clientHeight)}else void 0!==m.object.top?(m.panLeft(a*(m.object.right-m.object.left)/c.clientWidth),m.panUp(b*(m.object.top-m.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(a){void 0===a&&(a=d()),B/=a},this.dollyOut=function(a){void 0===a&&(a=d()),B*=a},this.update=function(){var a=this.object.position;v.copy(a).sub(this.target),v.applyQuaternion(G);var b=Math.atan2(v.x,v.z),d=Math.atan2(Math.sqrt(v.x*v.x+v.z*v.z),v.y);this.autoRotate&&this.rotateLeft(c()),b+=A,d+=z,d=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,d)),d=Math.max(n,Math.min(Math.PI-n,d));var e=v.length()*B;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(C),v.x=e*Math.sin(d)*Math.sin(b),v.y=e*Math.cos(d),v.z=e*Math.sin(d)*Math.cos(b),v.applyQuaternion(H),a.copy(this.target).add(v),this.object.lookAt(this.target),A=0,z=0,B=1,C.set(0,0,0),D.distanceToSquared(this.object.position)>n&&(this.dispatchEvent(I),D.copy(this.object.position))},this.reset=function(){F=E.NONE,this.target.copy(this.target0),this.object.position.copy(this.position0),this.update()},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",e,!1),this.domElement.addEventListener("mousewheel",h,!1),this.domElement.addEventListener("DOMMouseScroll",h,!1),this.domElement.addEventListener("touchstart",j,!1),this.domElement.addEventListener("touchend",l,!1),this.domElement.addEventListener("touchmove",k,!1),window.addEventListener("keydown",i,!1),this.update()},THREE.OrbitControls.prototype=Object.create(THREE.EventDispatcher.prototype),THREE.StereoEffect=function(a){this.separation=3;var b,c,d=new THREE.Vector3,e=new THREE.Quaternion,f=new THREE.Vector3,g=new THREE.PerspectiveCamera,h=new THREE.PerspectiveCamera;a.autoClear=!1,this.setSize=function(d,e){b=d/2,c=e,a.setSize(d,e)},this.render=function(i,j){i.updateMatrixWorld(),void 0===j.parent&&j.updateMatrixWorld(),j.matrixWorld.decompose(d,e,f),g.fov=j.fov,g.aspect=.5*j.aspect,g.near=j.near,g.far=j.far,g.updateProjectionMatrix(),g.position.copy(d),g.quaternion.copy(e),g.translateX(-this.separation),g.updateMatrixWorld(),h.near=j.near,h.far=j.far,h.projectionMatrix=g.projectionMatrix,h.position.copy(d),h.quaternion.copy(e),h.translateX(this.separation),h.updateMatrixWorld(),a.setViewport(0,0,2*b,c),a.clear(),a.setViewport(0,0,b,c),a.render(i,g),a.setViewport(b,0,b,c),a.render(i,h)}},function(a){"use strict";function b(){function b(){var b=a.innerWidth/a.innerHeight;this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.renderer.setSize(a.innerWidth,a.innerHeight),this.scene=new THREE.Scene,this.effect=new THREE.StereoEffect(this.renderer),this.camera=new THREE.PerspectiveCamera(90,b,.001,700),this.scene.add(this.camera),this.controls=new THREE.DeviceOrientationControls(this.camera,!0),this.orbitControls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.orbitControls.noZoom=!0,this.orbitControls.noPan=!0,this.orbitControls.autoRotate=!1,a.addEventListener("resize",this.resize.bind(this),!1),this._initControls=this.initControls.bind(this),a.addEventListener("deviceorientation",this._initControls,!1),setTimeout(this.resize.bind(this),0),this.animate=this.animate.bind(this),setTimeout(this.play.bind(this),0)}return b.prototype.initControls=function(b){b.alpha&&(a.removeEventListener("deviceorientation",this._initControls,!1),this.renderer.domElement.addEventListener("click",this.fullscreen.bind(this),!1),this.orbitControls.enabled=!1,this.controls.connect(),this.controls.update())},b.prototype.animate=function(){this._playing&&(requestAnimationFrame(this.animate),this.update(),this.render())},b.prototype.pause=function(){this._playing=!1},b.prototype.play=function(){this._playing||(this._playing=!0,this.animate())},b.prototype.update=function(){var b=this.width!==a.innerWidth||this.height!==a.innerHeight;b&&this.resize(),this.camera.updateProjectionMatrix(),this.controls.freeze===!1?this.controls.update():this.orbitControls.update()},b.prototype.render=function(){this.effect.render(this.scene,this.camera)},b.prototype.fullscreen=function(){this.renderer.domElement.requestFullscreen?this.renderer.domElement.requestFullscreen():this.renderer.domElement.msRequestFullscreen?this.renderer.domElement.msRequestFullscreen():this.renderer.domElement.mozRequestFullScreen?this.renderer.domElement.mozRequestFullScreen():this.renderer.domElement.webkitRequestFullscreen&&this.renderer.domElement.webkitRequestFullscreen()},b.prototype.resize=function(){this.width=a.innerWidth,this.height=a.innerHeight,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height),this.effect.setSize(this.width,this.height)},b}"undefined"==typeof THREE?console.error("Sensorama requires THREE.js to be defined: https://threejs.org"):"undefined"!=typeof Sensorama?console.warn("Sensorama is already defined"):a.Sensorama=b()}(window);